(function(a){H5PEditor.init=function(){H5PEditor.$=H5P.jQuery,H5PEditor.apiVersion=H5PIntegration.editor.apiVersion,H5PEditor.baseUrl='',H5PEditor.basePath=H5PIntegration.editor.libraryUrl,H5PEditor.fileIcon=H5PIntegration.editor.fileIcon,H5PEditor.ajaxPath=H5PIntegration.editor.ajaxPath,H5PEditor.filesPath=H5PIntegration.editor.filesPath,H5PEditor.copyrightSemantics=H5PIntegration.editor.copyrightSemantics,H5PEditor.metadataSemantics=H5PIntegration.editor.metadataSemantics,H5PEditor.assets=H5PIntegration.editor.assets,H5PEditor.contentId=H5PIntegration.editor.contentId;var b=a('input[name="library"]'),c=a('input[name="params"]'),d=a('#xhfp_editor'),e=a('#form_xhfp_edit_form'),f=a('#xhfp_edit_toolbar'),g=a('#xhfp_edit_toolbar_tutorial'),h=a('#xhfp_edit_toolbar_example'),i=a('#il_prop_cont_upload_file'),j=b.val(),k=c.val(),l=a('<div></div>').appendTo(d),m=new ns.Editor(j,k,l),n=a('iframe',d),o=n[0];n.on('load',function(){var b=o.contentWindow;if(''!==j){var c=b.H5PEditor.LibrarySelector.prototype.appendTo;b.H5PEditor.LibrarySelector.prototype.appendTo=function(){c.apply(this,arguments);var a=this.$selector.attr;this.$selector.attr=function(b){'disabled'===b?a.call(this,'disabled',!0):a.apply(this,arguments)}}}var d=b.H5PEditor.LibrarySelector.prototype.loadSemantics;b.H5PEditor.LibrarySelector.prototype.loadSemantics=function(b){if(d.apply(this,arguments),f.addClass('ilNoDisplay'),g.addClass('ilNoDisplay'),h.addClass('ilNoDisplay'),0===b.indexOf('H5P.IFrameEmbed')?i.removeClass('ilNoDisplay'):i.addClass('ilNoDisplay'),'string'==typeof b&&''!==b&&'-'!==b){var c=H5PEditor.getAjaxUrl('getTutorial',{library:m.getLibrary()});a.get(c,function(a){'object'!=typeof a&&(a=JSON.parse(a));var b=0;'tutorial_urL'in a&&(g.attr('href',a.tutorial_urL),g.removeClass('ilNoDisplay'),b++),'example_url'in a&&(h.attr('href',a.example_url),h.removeClass('ilNoDisplay'),b++),0<b&&f.removeClass('ilNoDisplay')})}}}),a('#xhfp_edit_form_submit, #xhfp_edit_form_submit_top').click(function(){this.dataset.clicked=!0}),e.submit(function(){var d=e.find('#xhfp_edit_form_submit[data-clicked="true"], #xhfp_edit_form_submit_top[data-clicked="true"]');if(Array.prototype.forEach.call(a('#xhfp_edit_form_submit, #xhfp_edit_form_submit_top'),function(a){delete a.dataset.clicked}),0<d.length){var f=m.getLibrary(),g=m.getParams();'string'==typeof f&&''!==f&&'-'!==f&&'object'==typeof g&&(b.val(f),c.val(JSON.stringify(g)))}return!0})},H5PEditor.getAjaxUrl=function(a,b){var c=H5PIntegration.editor.ajaxPath+a;return void 0!==b&&Object.keys(b).forEach(function(a){c+='&'+a+'='+b[a]}),c},a(document).ready(H5PEditor.init)})(H5P.jQuery);
